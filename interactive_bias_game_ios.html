<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–ü—Å–∏—Ö–æ–ª–æ–≥—ñ—è –≤–∏–±–æ—Ä—É ‚Äî iOS friendly</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/pdfmake.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/vfs_fonts.js"></script>
  <style>
    body{font-family:system-ui,-apple-system,'Segoe UI',Roboto,Arial,sans-serif;background:#f3f5ff;margin:0;padding:24px}
    .app{max-width:960px;margin:0 auto;background:#fff;border-radius:16px;box-shadow:0 10px 30px rgba(0,0,0,.08);overflow:hidden}
    header{background:linear-gradient(135deg,#2c3e50,#3498db);color:#fff;padding:20px;text-align:center}
    .main{padding:20px}
    .step{display:none}
    .step.active{display:block}
    .nav{display:flex;justify-content:space-between;align-items:center;padding:12px 0;border-top:1px solid #eaecef;margin-top:12px}
    .btn{background:#e74c3c;border:none;color:#fff;border-radius:999px;padding:10px 18px;font-weight:600;cursor:pointer}
    .btn.secondary{background:#7f8c8d}
    .info{background:#fff3cd;border:1px solid #ffeeba;color:#856404;padding:10px;border-radius:8px;margin:10px 0}
    .ok{background:#eaf7ef;border:1px solid #b7e1c1;color:#2b6b3f;padding:10px;border-radius:8px;margin:10px 0}
    .hidden{display:none}
    .analysis textarea{width:100%;min-height:70px}
  </style>
</head>
<body>
  <div class="app">
    <header>
      <h1>–ü—Å–∏—Ö–æ–ª–æ–≥—ñ—è –≤–∏–±–æ—Ä—É –≤ –º–µ–¥—ñ–∞–ø—Ä–æ–º–æ—Ü—ñ—ó</h1>
      <p>iPhone/iPad —Å—É–º—ñ—Å–Ω–∞ –≤–µ—Ä—Å—ñ—è</p>
    </header>
    <div class="main">
      <div id="iosWarning" class="info hidden"></div>
      <div id="cdnWarning" class="info hidden">–°–∫—Ä–∏–ø—Ç–∏ –¥–ª—è PDF –Ω–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–∏–ª–∏—Å—è. –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ –≤–∏ –≤—ñ–¥–∫—Ä–∏–ª–∏ —Ü—é —Å—Ç–æ—Ä—ñ–Ω–∫—É —É Safari —á–µ—Ä–µ–∑ HTTPS (–Ω–µ —É –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–º—É –ø–µ—Ä–µ–≥–ª—è–¥—ñ ¬´–§–∞–π–ª–∏¬ª), —ñ —â–æ —î –¥–æ—Å—Ç—É–ø –¥–æ –Ü–Ω—Ç–µ—Ä–Ω–µ—Ç—É.</div>

      <div class="step active" id="step0">
        <p>–©–æ–± —É–Ω–∏–∫–Ω—É—Ç–∏ –ø—Ä–æ–±–ª–µ–º –Ω–∞ iPhone:</p>
        <ul>
          <li>–í—ñ–¥–∫—Ä–∏–≤–∞–π—Ç–µ —Å—Ç–æ—Ä—ñ–Ω–∫—É —É <strong>Safari</strong>, –∞ –Ω–µ —É –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–º—É –ø–µ—Ä–µ–≥–ª—è–¥—ñ ¬´–§–∞–π–ª–∏¬ª.</li>
          <li>–ë–∞–∂–∞–Ω–æ —Ä–æ–∑–º—ñ—Å—Ç–∏—Ç–∏ —Ñ–∞–π–ª –Ω–∞ <strong>HTTPS</strong> (GitHub Pages, Netlify —Ç–æ—â–æ).</li>
          <li>–ù–∞ iOS PDF –∫—Ä–∞—â–µ <strong>–≤—ñ–¥–∫—Ä–∏–≤–∞—Ç–∏</strong> —É –Ω–æ–≤—ñ–π –≤–∫–ª–∞–¥—Ü—ñ (–∞ –Ω–µ ¬´–∑–∞–≤–∞–Ω—Ç–∞–∂—É–≤–∞—Ç–∏¬ª).</li>
        </ul>
        <div class="ok">–í—Å–µ –æ–¥–Ω–æ –º–æ–∂–Ω–∞ –ø—Ä–∞—Ü—é–≤–∞—Ç–∏ –ª–æ–∫–∞–ª—å–Ω–æ ‚Äî –ø—Ä–æ—Å—Ç–æ –≤—ñ–¥–∫—Ä–∏–π—Ç–µ —Ü–µ–π —Ñ–∞–π–ª —É Safari —Ç–∞ –¥–æ–∑–≤–æ–ª—å—Ç–µ –≤—ñ–¥–∫—Ä–∏—Ç—Ç—è PDF.</div>
        <div style="margin:12px 0;">
          <label>–ù–∞–∑–≤–∞ –≥—Ä—É–ø–∏:
            <input type="text" id="groupName" placeholder="–ì—Ä—É–ø–∞ 3" />
          </label>
        </div>
      </div>

      <div class="step" id="step1">
        <div class="analysis">
          <h3>Confirmation Bias ‚Äî –ê–Ω–∞–ª—ñ–∑</h3>
          <textarea id="manifestation1" placeholder="–ü—Ä–æ—è–≤ —É –∞—É–¥–∏—Ç–æ—Ä—ñ—ó"></textarea>
          <textarea id="strategy1" placeholder="–°—Ç—Ä–∞—Ç–µ–≥—ñ—è"></textarea>
          <textarea id="example1" placeholder="–ü—Ä–∏–∫–ª–∞–¥"></textarea>
        </div>
      </div>

      <div class="step" id="stepFinal">
        <h3>–ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è</h3>
        <button class="btn" onclick="generatePDF()">üìÑ –ó–±–µ—Ä–µ–≥—Ç–∏ —É PDF</button>
      </div>

      <div class="nav">
        <button class="btn secondary" onclick="prev()">‚Üê –ù–∞–∑–∞–¥</button>
        <span id="counter"></span>
        <button class="btn" onclick="next()">–î–∞–ª—ñ ‚Üí</button>
      </div>

      <div id="openInSafari" class="info hidden">
        –í–∏–≥–ª—è–¥–∞—î, —â–æ —Å—Ç–æ—Ä—ñ–Ω–∫–∞ –≤—ñ–¥–∫—Ä–∏—Ç–∞ –ª–æ–∫–∞–ª—å–Ω–æ (<code>file://</code>) –Ω–∞ iOS. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å –∫–Ω–æ–ø–∫—É –Ω–∏–∂—á–µ, —â–æ–± –≤—ñ–¥–∫—Ä–∏—Ç–∏ —É Safari:
        <div style="margin-top:8px"><button class="btn" onclick="openInSafari()">–í—ñ–¥–∫—Ä–∏—Ç–∏ —É Safari</button></div>
      </div>
    </div>
  </div>

<script>
const steps = ['step0','step1','stepFinal'];
let idx = 0;
function show(){ document.querySelectorAll('.step').forEach(s=>s.classList.remove('active')); document.getElementById(steps[idx]).classList.add('active'); document.getElementById('counter').textContent = `–ö—Ä–æ–∫ ${idx+1} –∑ ${steps.length}`; }
function next(){ if(idx < steps.length-1) idx++; else idx=0; show(); }
function prev(){ if(idx>0) idx--; show(); }
show();

// iOS detection and warnings
function isiOS(){ return /iP(hone|ad|od)/.test(navigator.userAgent); }
function isFileURL(){ return location.protocol === 'file:'; }
function showWarn(elId, msg){ const el=document.getElementById(elId); el.textContent = msg; el.classList.remove('hidden'); }

document.addEventListener('DOMContentLoaded', ()=>{
  if(isiOS()){
    if(isFileURL()){
      showWarn('iosWarning','–í–∏ –≤—ñ–¥–∫—Ä–∏–ª–∏ –ª–æ–∫–∞–ª—å–Ω–∏–π —Ñ–∞–π–ª –Ω–∞ iOS. –£ ¬´–ü–æ–ø–µ—Ä–µ–¥–Ω—å–æ–º—É –ø–µ—Ä–µ–≥–ª—è–¥—ñ —Ñ–∞–π–ª—ñ–≤¬ª JavaScript –º–æ–∂–µ –Ω–µ –ø—Ä–∞—Ü—é–≤–∞—Ç–∏. –í—ñ–¥–∫—Ä–∏–π—Ç–µ —É Safari —á–µ—Ä–µ–∑ –∫–Ω–æ–ø–∫—É –Ω–∏–∂—á–µ.');
      document.getElementById('openInSafari').classList.remove('hidden');
    } else {
      showWarn('iosWarning','iOS –≤–∏—è–≤–ª–µ–Ω–æ. –î–ª—è PDF –±—É–¥–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–æ ¬´–í—ñ–¥–∫—Ä–∏—Ç–∏ –≤ –Ω–æ–≤—ñ–π –≤–∫–ª–∞–¥—Ü—ñ¬ª, —â–æ–± –æ–±—ñ–π—Ç–∏ –±–ª–æ–∫—É–≤–∞–Ω–Ω—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω—å.');
    }
  }
  setTimeout(()=>{
    if(typeof pdfMake === 'undefined') document.getElementById('cdnWarning').classList.remove('hidden');
  }, 1000);
});

function openInSafari(){
  // Try to open the same file path via Safari; user may need to copy/share manually
  alert('–ü–æ–¥—ñ–ª—ñ—Ç—å—Å—è —Ü–∏–º —Ñ–∞–π–ª–æ–º —ñ –≤—ñ–¥–∫—Ä–∏–π—Ç–µ –π–æ–≥–æ —É Safari (—á–µ—Ä–µ–∑ ¬´–ü–æ–¥—ñ–ª–∏—Ç–∏—Å—è¬ª ‚Üí ¬´–í—ñ–¥–∫—Ä–∏—Ç–∏ –≤ Safari¬ª).');
}

// PDF
pdfMake && (pdfMake.fonts = { Roboto: { normal: 'Roboto-Regular.ttf', bold: 'Roboto-Medium.ttf', italics: 'Roboto-Italic.ttf', bolditalics: 'Roboto-MediumItalic.ttf' } });

function field(id){ return (document.getElementById(id)?.value || '').trim(); }

function generatePDF(){
  if(typeof pdfMake === 'undefined'){ alert('–°–∫—Ä–∏–ø—Ç PDF –Ω–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–∏–≤—Å—è. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —ñ–Ω—Ç–µ—Ä–Ω–µ—Ç —ñ –≤—ñ–¥–∫—Ä–∏–π—Ç–µ —Å—Ç–æ—Ä—ñ–Ω–∫—É —É Safari —á–µ—Ä–µ–∑ HTTPS.'); return; }

  const groupName = field('groupName') || '–ë–µ–∑ –Ω–∞–∑–≤–∏';
  const dateStr = new Date().toLocaleDateString('uk-UA');

  const content = [
    { text: '–ê–Ω–∞–ª—ñ–∑ –∫–æ–≥–Ω—ñ—Ç–∏–≤–Ω–∏—Ö —É–ø–µ—Ä–µ–¥–∂–µ–Ω—å –≤ –º–µ–¥—ñ–∞–ø—Ä–æ–º–æ—Ü—ñ—ó', style: 'header' },
    { text: `–ì—Ä—É–ø–∞: ${groupName}` },
    { text: `–î–∞—Ç–∞: ${dateStr}`, margin: [0,0,0,10] },
    { text: 'Confirmation Bias (–£–ø–µ—Ä–µ–¥–∂–µ–Ω–Ω—è –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è)', style: 'subheader' },
    { text: '–ü—Ä–æ—è–≤ —É –∞—É–¥–∏—Ç–æ—Ä—ñ—ó:', bold: true }, { text: field('manifestation1') || '(–Ω–µ –∑–∞–ø–æ–≤–Ω–µ–Ω–æ)' },
    { text: '–°—Ç—Ä–∞—Ç–µ–≥—ñ—è:', bold: true, margin:[0,6,0,0] }, { text: field('strategy1') || '(–Ω–µ –∑–∞–ø–æ–≤–Ω–µ–Ω–æ)' },
    { text: '–ü—Ä–∏–∫–ª–∞–¥:', bold: true, margin:[0,6,0,0] }, { text: field('example1') || '(–Ω–µ –∑–∞–ø–æ–≤–Ω–µ–Ω–æ)' }
  ];

  const docDefinition = {
    content,
    defaultStyle: { font: 'Roboto', fontSize: 11, lineHeight: 1.25 },
    styles: { header: { fontSize: 18, bold: true, margin: [0,0,0,6] }, subheader: { fontSize: 14, bold: true, margin:[0,8,0,4] } }
  };

  const fileName = `–ê–Ω–∞–ª—ñ–∑_${groupName.replace(/\s/g,'_')}_${new Date().toISOString().slice(0,10)}.pdf`;
  // On iOS, prefer .open() to avoid download blockers
  const useOpen = isiOS();
  const pdf = pdfMake.createPdf(docDefinition);
  if(useOpen){ pdf.open(); } else { pdf.download(fileName); }
}
</script>
</body>
</html>
